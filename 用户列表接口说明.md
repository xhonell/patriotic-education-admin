# ç”¨æˆ·åˆ—è¡¨æ¥å£è¯´æ˜

## ğŸ“¡ æ¥å£ä¿¡æ¯

### GET /user/list

#### åŸºæœ¬ä¿¡æ¯
- **URL**: `/user/list`
- **æ–¹æ³•**: `GET`
- **è®¤è¯**: éœ€è¦ token

#### è¯·æ±‚å‚æ•° (Query Parameters)
```javascript
{
  page: 1,           // é¡µç ï¼ˆå¿…å¡«ï¼‰
  pageSize: 10,      // æ¯é¡µæ•°é‡ï¼ˆå¿…å¡«ï¼‰
  username: '',      // ç”¨æˆ·åï¼ˆå¯é€‰ï¼‰
  email: '',         // é‚®ç®±ï¼ˆå¯é€‰ï¼‰
  role: null         // è§’è‰²ï¼ˆå¯é€‰ï¼Œ1:æ™®é€šç”¨æˆ· 2:æ•™å¸ˆ 3:ç³»ç»Ÿç®¡ç†å‘˜ï¼‰
}
```

#### å“åº”æ ¼å¼
```java
Result<List<RedisUser>>

{
  "code": 200,
  "message": "success",
  "data": [
    {
      "id": 5,
      "username": "xhonell",
      "email": "xhonell@163.com",
      "phone": "18996459789",
      "avatarId": 11,
      "avatarUrl": "https://pe-1329896228.cos.ap-chengdu.myqcloud.com/images/...",
      "role": 2,                      // 1:æ™®é€šç”¨æˆ· 2:æ•™å¸ˆ 3:ç³»ç»Ÿç®¡ç†å‘˜
      "status": false,                // true:å¯ç”¨ false:ç¦ç”¨
      "createTime": "2025-10-19T23:16:01",
      "updateTime": "2025-10-19T23:16:34"
    }
  ]
}
```

## ğŸ” å­—æ®µè¯´æ˜

### RedisUser å®ä½“ç±»
```java
@Data
@AllArgsConstructor
@NoArgsConstructor
@Accessors(chain = true)
@JsonInclude(JsonInclude.Include.NON_NULL)
public class RedisUser {
    private Long id;                    // ç”¨æˆ·ID
    private String username;            // ç”¨æˆ·å
    private String email;               // é‚®ç®±
    private LocalDateTime createTime;   // åˆ›å»ºæ—¶é—´
    private LocalDateTime updateTime;   // æ›´æ–°æ—¶é—´
    private Integer role;               // è§’è‰²ï¼ˆ1:æ™®é€šç”¨æˆ· 2:æ•™å¸ˆ 3:ç³»ç»Ÿç®¡ç†å‘˜ï¼‰
    private Long avatarId;              // å¤´åƒID
    private String phone;               // æ‰‹æœºå·
    private Boolean status;             // çŠ¶æ€ï¼ˆtrue:å¯ç”¨ false:ç¦ç”¨ï¼‰
    private String avatarUrl;           // å¤´åƒURL
}
```

### è§’è‰²è¯´æ˜
| roleå€¼ | è§’è‰²åç§° | è¯´æ˜ |
|--------|---------|------|
| 1 | æ™®é€šç”¨æˆ· | åŸºæœ¬æƒé™ |
| 2 | æ•™å¸ˆ | æ•™å­¦æƒé™ |
| 3 | ç³»ç»Ÿç®¡ç†å‘˜ | æœ€é«˜æƒé™ |

### çŠ¶æ€è¯´æ˜
| status | çŠ¶æ€ | è¯´æ˜ |
|--------|------|------|
| true | å¯ç”¨ | è´¦å·æ­£å¸¸ä½¿ç”¨ |
| false | ç¦ç”¨ | è´¦å·è¢«ç¦ç”¨ |

## ğŸ’» å‰ç«¯å®ç°

### 1. API æ¥å£å®šä¹‰
```javascript
// src/api/user.js
import request from '@/utils/request'

export function getUserList(params) {
  return request({
    url: '/user/list',
    method: 'get',
    params  // { page, pageSize, username, email, role }
  })
}
```

### 2. é¡µé¢è°ƒç”¨
```javascript
// src/views/user/list.vue
import { getUserList } from '@/api/user'

// åŠ è½½ç”¨æˆ·åˆ—è¡¨
const loadUserList = async () => {
  loading.value = true
  try {
    const params = {
      page: pagination.page,
      pageSize: pagination.pageSize,
      username: searchForm.username,
      email: searchForm.email,
      role: searchForm.role
    }
    
    const data = await getUserList(params)
    userList.value = data
  } catch (error) {
    ElMessage.error('è·å–ç”¨æˆ·åˆ—è¡¨å¤±è´¥')
  } finally {
    loading.value = false
  }
}
```

### 3. åˆ†é¡µå‚æ•°
```javascript
const pagination = reactive({
  page: 1,        // å½“å‰é¡µç 
  pageSize: 10,   // æ¯é¡µæ•°é‡
  total: 0        // æ€»æ•°ï¼ˆéœ€è¦åç«¯è¿”å›ï¼‰
})

// é¡µç æ”¹å˜
const handleCurrentChange = (page) => {
  pagination.page = page
  loadUserList()
}

// æ¯é¡µæ•°é‡æ”¹å˜
const handleSizeChange = (size) => {
  pagination.pageSize = size
  pagination.page = 1
  loadUserList()
}
```

### 4. æœç´¢åŠŸèƒ½
```javascript
const searchForm = reactive({
  username: '',
  email: '',
  role: ''
})

// æœç´¢
const handleSearch = () => {
  pagination.page = 1
  loadUserList()
}

// é‡ç½®
const handleReset = () => {
  searchForm.username = ''
  searchForm.email = ''
  searchForm.role = ''
  pagination.page = 1
  loadUserList()
}
```

## ğŸ¨ è¡¨æ ¼æ˜¾ç¤º

### è¡¨æ ¼åˆ—é…ç½®
```vue
<el-table :data="userList" v-loading="loading">
  <el-table-column prop="id" label="ç”¨æˆ·ID" width="80" />
  
  <!-- å¤´åƒ -->
  <el-table-column label="å¤´åƒ" width="80">
    <template #default="{ row }">
      <el-avatar :src="row.avatarUrl" />
    </template>
  </el-table-column>
  
  <!-- ç”¨æˆ·å -->
  <el-table-column prop="username" label="ç”¨æˆ·å" />
  
  <!-- é‚®ç®± -->
  <el-table-column prop="email" label="é‚®ç®±" />
  
  <!-- æ‰‹æœºå· -->
  <el-table-column prop="phone" label="æ‰‹æœºå·" />
  
  <!-- è§’è‰² -->
  <el-table-column prop="role" label="è§’è‰²">
    <template #default="{ row }">
      <el-tag :type="getRoleType(row.role)">
        {{ getRoleName(row.role) }}
      </el-tag>
    </template>
  </el-table-column>
  
  <!-- åˆ›å»ºæ—¶é—´ -->
  <el-table-column prop="createTime" label="åˆ›å»ºæ—¶é—´">
    <template #default="{ row }">
      {{ formatTime(row.createTime) }}
    </template>
  </el-table-column>
  
  <!-- çŠ¶æ€ -->
  <el-table-column prop="status" label="çŠ¶æ€">
    <template #default="{ row }">
      <el-switch v-model="row.status" @change="handleStatusChange(row)" />
    </template>
  </el-table-column>
  
  <!-- æ“ä½œ -->
  <el-table-column label="æ“ä½œ" fixed="right">
    <template #default="{ row }">
      <el-button text @click="handleView(row)">æŸ¥çœ‹</el-button>
      <el-button text @click="handleEdit(row)">ç¼–è¾‘</el-button>
      <el-button text @click="handleDelete(row)">åˆ é™¤</el-button>
    </template>
  </el-table-column>
</el-table>
```

## ğŸ“Š å®Œæ•´è¯·æ±‚ç¤ºä¾‹

### åŸºæœ¬è¯·æ±‚
```javascript
// GET /user/list?page=1&pageSize=10
await getUserList({
  page: 1,
  pageSize: 10
})
```

### å¸¦æœç´¢æ¡ä»¶
```javascript
// GET /user/list?page=1&pageSize=10&username=xhonell&role=2
await getUserList({
  page: 1,
  pageSize: 10,
  username: 'xhonell',
  role: 2
})
```

### å“åº”æ•°æ®å¤„ç†
```javascript
const data = await getUserList(params)

// å‡è®¾å“åº”æ ¼å¼
{
  code: 200,
  message: 'success',
  data: [
    { id: 1, username: '...', ... },
    { id: 2, username: '...', ... }
  ]
}

// è®¾ç½®è¡¨æ ¼æ•°æ®
userList.value = data
```

## ğŸ”§ å·¥å…·å‡½æ•°

### è§’è‰²åç§°è½¬æ¢
```javascript
import { getRoleName } from '@/types/user'

getRoleName(1)  // "æ™®é€šç”¨æˆ·"
getRoleName(2)  // "æ•™å¸ˆ"
getRoleName(3)  // "ç³»ç»Ÿç®¡ç†å‘˜"
```

### æ—¶é—´æ ¼å¼åŒ–
```javascript
import { formatTime } from '@/types/user'

formatTime('2025-10-19T23:16:01')  // "2025-10-19 23:16"
```

### è§’è‰²æ ‡ç­¾ç±»å‹
```javascript
const getRoleType = (role) => {
  const types = {
    1: 'info',     // æ™®é€šç”¨æˆ· - ç°è‰²
    2: 'warning',  // æ•™å¸ˆ - æ©™è‰²
    3: 'danger'    // ç³»ç»Ÿç®¡ç†å‘˜ - çº¢è‰²
  }
  return types[role] || 'info'
}
```

## ğŸ“ åç«¯åˆ†é¡µè¯´æ˜

### PageUtils.startPage
```java
// åç«¯ä½¿ç”¨ PageHelper åˆ†é¡µ
PageUtils.startPage(request.getPage(), request.getPageSize());
List<RedisUser> list = userService.selectList(request);
```

### åˆ†é¡µå‚æ•°
- `page`: é¡µç ï¼ˆä»1å¼€å§‹ï¼‰
- `pageSize`: æ¯é¡µæ•°é‡

### æ³¨æ„äº‹é¡¹
1. å‰ç«¯ä¼ é€’ `page` å’Œ `pageSize` å‚æ•°
2. åç«¯è‡ªåŠ¨åˆ†é¡µå¤„ç†
3. å‰ç«¯éœ€è¦æ˜¾ç¤ºæ€»æ•°ï¼Œå¯èƒ½éœ€è¦åç«¯è¿”å› total

## âš ï¸ å¸¸è§é—®é¢˜

### 1. åˆ†é¡µæ€»æ•°è·å–
**é—®é¢˜**: å¦‚ä½•è·å–æ€»è®°å½•æ•°ï¼Ÿ

**æ–¹æ¡ˆ1**: åç«¯è¿”å›åˆ†é¡µä¿¡æ¯
```java
Result<PageInfo<RedisUser>>
{
  code: 200,
  data: {
    list: [...],
    total: 100,
    pageNum: 1,
    pageSize: 10
  }
}
```

**æ–¹æ¡ˆ2**: å“åº”å¤´è¿”å›
```
X-Total-Count: 100
```

å‰ç«¯è·å–ï¼š
```javascript
response.headers['x-total-count']
```

### 2. è¯·æ±‚å‚æ•°ä¸ºç©º
ç¡®ä¿ç©ºå€¼ä¸å‘é€ï¼š
```javascript
const params = {
  page: pagination.page,
  pageSize: pagination.pageSize
}

// åªæ·»åŠ éç©ºå‚æ•°
if (searchForm.username) params.username = searchForm.username
if (searchForm.email) params.email = searchForm.email
if (searchForm.role) params.role = searchForm.role
```

### 3. æ—¶é—´æ ¼å¼
åç«¯è¿”å› ISO 8601 æ ¼å¼ï¼š`2025-10-19T23:16:01`
å‰ç«¯éœ€è¦æ ¼å¼åŒ–æ˜¾ç¤ºï¼š`2025-10-19 23:16`

## âœ… åŠŸèƒ½æ¸…å•

- [x] è·å–ç”¨æˆ·åˆ—è¡¨æ¥å£
- [x] åˆ†é¡µåŠŸèƒ½
- [x] æœç´¢åŠŸèƒ½ï¼ˆç”¨æˆ·åã€é‚®ç®±ã€è§’è‰²ï¼‰
- [x] è§’è‰²æ ‡ç­¾æ˜¾ç¤º
- [x] å¤´åƒæ˜¾ç¤º
- [x] æ—¶é—´æ ¼å¼åŒ–
- [x] çŠ¶æ€åˆ‡æ¢
- [x] åˆ é™¤ç”¨æˆ·
- [x] è¡¨æ ¼åŠ è½½çŠ¶æ€

## ğŸš€ æµ‹è¯•æ­¥éª¤

1. å¯åŠ¨åç«¯æœåŠ¡ï¼ˆ8801ç«¯å£ï¼‰
2. å¯åŠ¨å‰ç«¯ï¼š`npm run dev`
3. ç™»å½•ç³»ç»Ÿ
4. ç‚¹å‡»"ç”¨æˆ·ç®¡ç†" â†’ "ç”¨æˆ·åˆ—è¡¨"
5. æŸ¥çœ‹ç”¨æˆ·åˆ—è¡¨æ•°æ®
6. æµ‹è¯•æœç´¢åŠŸèƒ½
7. æµ‹è¯•åˆ†é¡µåŠŸèƒ½
8. æµ‹è¯•çŠ¶æ€åˆ‡æ¢

---

**ç”¨æˆ·åˆ—è¡¨æ¥å£å¯¹æ¥å®Œæˆï¼** ğŸ‘¥âœ¨

